package local;

import org.jboss.cache.Fqn;
import org.jboss.cache.Cache;
eventclass Datarace{

	group localGroup{
		localhost
	}
	
	automaton dataraceDetector(){
 		start init: (poner -> middle)||(obtener -> datarace);
 		middle:  (poner -> middle)||(obtener -> middle);
 		end datarace;
 	}
 	
	event poner(): call(* Cache.get(Fqn, Object)) && host(localGroup);
	
	event obtener(): call(* Cache.put(Fqn, Object, Object)) && host(localGroup);
	
 	reaction before dataraceDetector.datarace{
		String msg = "DataRace detected!";
		System.out.println("----------------------------------------");
		System.out.println(msg);
		System.out.println("----------------------------------------");
	}
	
}